<!doctype html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.0" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="豪翔天下,Python开发工程师,全栈开发工程师" />





  <link rel="alternate" href="/atom.xml" title="豪翔天下" type="application/atom+xml" />




  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.0" />






<meta name="description" content="豪翔天下的个人博客">
<meta property="og:type" content="website">
<meta property="og:title" content="豪翔天下">
<meta property="og:url" content="https://haofly.net/page/4/index.html">
<meta property="og:site_name" content="豪翔天下">
<meta property="og:description" content="豪翔天下的个人博客">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="豪翔天下">
<meta name="twitter:description" content="豪翔天下的个人博客">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    sidebar: {"position":"left","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://haofly.net/page/4/"/>





  <title> 豪翔天下 </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  


<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-47480072-1', 'auto');
  ga('send', 'pageview');
</script>


  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?d06802e96e214bdb413a40b263d4cc15";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>








  
  
    
  

  <div class="container one-collumn sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">豪翔天下</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle">Change My World by Program</p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-favorites">
          <a href="/favorites.html" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-flag"></i> <br />
            
            menu.favorites
          </a>
        </li>
      
        
        <li class="menu-item menu-item-wiki">
          <a href="https://wiki.haofly.net" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-key"></i> <br />
            
            menu.wiki
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="https://haofly.net/mysql-design-tips/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="haofly">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/uploads/avatar.png">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="豪翔天下">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="豪翔天下" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/mysql-design-tips/" itemprop="url">
                  MySQL之设计方法
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2015-12-10T08:16:46+08:00">
                2015-12-10
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/编程之路/" itemprop="url" rel="index">
                    <span itemprop="name">编程之路</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <a href="/mysql-design-tips/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="mysql-design-tips/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="关于架构"><a href="#关于架构" class="headerlink" title="关于架构"></a>关于架构</h2><ul>
<li>一般把读取的请求放在缓存(Redis)，而更新请求放在数据库</li>
</ul>
<h2 id="关于索引"><a href="#关于索引" class="headerlink" title="关于索引"></a>关于索引</h2><ul>
<li>数据查询只能用到一个索引，不过这个只是说的是单表查询，联表查询实际上每个表都可以用到其独立的索引</li>
<li><p>有些时候索引并不会用到，比如<br>where key like ‘keyword\%’：这里可以用到key索引<br>where key like ‘\%keyword\%’：这里用不到key的索引</p>
</li>
<li><p>适当建立复合索引：<br>前几天看了“caoz的梦呓”的文章《如何应对并发(1) - 关于数据索引》，理解了建立复合索引所需要考虑的一些东西，顺序不同效率也有很大的不同。<br>‘SELECT * FROM user where area = ‘$area’ order by lastlogin desc limit 30;’<br>如果只把area当做索引，那么数据库会把符合这个area的所有结果都拿出来，然后按照lastlogin来进行排序；<br>如果只把lastlogin做为索引，那么数据库会从最后一条开始往前遍历，每条都会对比area，直到数出30条<br>如果lastlogin+area建立符合，和单独lastlogin索引是一样的<br>如果area+lastlogin，把两个字段拼接然后排好序后，看这条SQL在这个数列中查询的提现，所命中的完全是连续的30条，仅仅遍历30条索引即可<br>我最先以为简历复合索引也会是先查找出area，再拿出来排序哟，但其实索引都是预先排好了的，这里就相当于先按照area排序，area相同的再按照lastlog<br>in进行排序，这样，只要找到area，然后取前面30条就可以了，就像电话簿一样，先找姓氏，姓氏相同的也会按照名排好序的。</p>
</li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="https://haofly.net/raspberrypi/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="haofly">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/uploads/avatar.png">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="豪翔天下">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="豪翔天下" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/raspberrypi/" itemprop="url">
                  玩转树莓派2
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2015-12-08T02:58:50+08:00">
                2015-12-08
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/就是爱玩/" itemprop="url" rel="index">
                    <span itemprop="name">就是爱玩</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <a href="/raspberrypi/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="raspberrypi/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>想在家里做NAS、DNS等私有云服务，但是无奈家里淘汰下来的电脑已无力承担如此重任。没办法了，就只能试试树莓派。不试不知道，一试吓一跳，完全就是一手掌大小的<br>电脑，听说desktop版本还能使用word等软件，虽然只有1GB内存，但是200多块(淘宝店)就能买到这个东西，那是非常值了。当然，作为一个技术爱好者，别<br>人是完全无法体会这种快乐的。要是其功耗再低点或者能采用其它的供电方式(比如无线供电、电池供电)，感觉完全能颠覆智能市场。  </p>
<h2 id="制作启动镜像"><a href="#制作启动镜像" class="headerlink" title="制作启动镜像"></a><strong>制作启动镜像</strong></h2><p>镜像下载：<a href="https://www.raspberrypi.org/downloads/" target="_blank" rel="external">https://www.raspberrypi.org/downloads/</a>，我下载的是RASPBIAN分支，因为其是官方提供且基于Debian，和Ubuntu操作一样.<br><strong>Mac环境</strong>：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">$ df  # 查看当前已经挂载的卷,一般sd卡在最后，Filesystem是/dev/disk2s1，Mounted on /Volumes/No Name，可以在Finder里面将sd卡的名字改为Pi(我那个默认是No Name)</div><div class="line">$ diskutil unmount /dev/disk2s1   #将sd卡卸载</div><div class="line">Volume Pi on disk2s1 unmounted</div><div class="line">$ diskutil list # 查看是否有sd卡设备</div><div class="line">$ dd bs=4m if=pi.img of=/dev/rdisk2   #将镜像文件pi.img写入sd卡，需要注意这条命令使用的是rdisk2，这是原始字符设备</div><div class="line">$ diskutil unmountDisk /dev/disk2  # 再卸载sd卡，此时可以拔出来插入树莓派的sd卡槽了</div></pre></td></tr></table></figure></p>
<h2 id="启动操作系统"><a href="#启动操作系统" class="headerlink" title="启动操作系统"></a><strong>启动操作系统</strong></h2><p>收到货的那天，发现其有一个DC接口，还以为是通过DC接口供电，出门走了一圈都没发现有卖这货的，于是回家，自习已看，发现可以用Android的电源为期供电的，<br>那接口名字忘了。和网上建议的一样，我采用的是5V 2A的供电设备(其实是直接插到小米插线板上的)<br>然后，我又发现，我家里没多的网线，那怎么办，我装的不是desktop版本，没有网线就不能SSH进去。不过还好，它支持HDMI，于是我把它功过HDMI连接上了<br>家里40英寸的电视，(HDMI高清显示，真他妈爽)就像这样，还通过USB插了外置键盘。<br><img src="http://7xnc86.com1.z0.glb.clouddn.com/raspberrypi_1.jpg" alt="">  </p>
<p>默认是通电自动启动的，所以插上电就会进入系统了，默认用户名pi，默认密码是raspberry，接着就做一些基本的配置，通过<code>sudo raspi-config</code>来运行设置工具：</p>
<ul>
<li>第一项将sd卡的剩余空间全部用来使用</li>
<li>然后修改<code>Internationalisaton Options</code>里面的时区及默认字符编码<code>zh_CN GB2312/zh_CN.UTF-8 UTF-8</code></li>
<li>接着修改源，这个国度没办法的事  </li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">$ sudo nano /etc/apt/sources.list.d/raspi.list</div><div class="line">修改为如下：</div><div class="line">deb http://mirrors.ustc.edu.cn/archive.raspberrypi.org/debian/ jessie main</div><div class="line">	</div><div class="line">$ sudo nano /etc/apt/sources.list  </div><div class="line">修改为如下：</div><div class="line">deb http://mirrors.ustc.edu.cn/raspbian/raspbian/ jessie main non-free contrib  </div><div class="line">deb-src http://mirrors.ustc.edu.cn/raspbian/raspbian/ jessie main non-free contrib</div></pre></td></tr></table></figure>
<ul>
<li><p>最后，安装必要的软件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">sudo apt-get update &amp;&amp; sudo apt-get upgrade </div><div class="line">sudo apt-get install vim tree ttf-wqy-microhei git</div><div class="line"></div><div class="line"># 根据python.md安装python3</div></pre></td></tr></table></figure>
</li>
<li><p>WIFI设置</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">当然，我不可能一直用电视作显示器吧，这时候我买的无线设备就有用场了，直接通过USB插到树莓派上，然后设置wifi  </div><div class="line">$ ifconfig # 可以看到wlan0，表示已经识别无线网卡</div><div class="line">$ sudo vim /etc/network/interfaces添加或修改关于wlan0的配置</div><div class="line">auto wlan0</div><div class="line">allow-hotplug wlan0</div><div class="line">iface wlan0 inet dhcp</div><div class="line">wpa-ssid WIFI名称</div><div class="line">wpa-psk WIFI密码</div><div class="line"></div><div class="line"># 然后通过如下命令重启网卡</div><div class="line">sudo ifdown wlan0 &amp;&amp; sudo ifup wlan0</div></pre></td></tr></table></figure>
</li>
<li><p>搭建ownCloud私有云</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div></pre></td><td class="code"><pre><div class="line">作为私有云方案，我选择的ownCloud，而不是Samba，因为Samba功能仅仅算是ftp的共享，而不是一个私有云方案，当然ownCloud也有为人诟病的地方，比如内存占用高(树莓派2上占用100多MB)，另一个是因为它本身是基于Apache的，树莓派内存总共就1G，我可不想既有Apache又有Nginx，所以直接用的是Nginx+php5-fpm的方案，不过这样子，配置过程就有点麻烦了。  </div><div class="line"># 首先，安装基本服务</div><div class="line">sudo apt-get install php5-common php5-cli php5-fpm</div><div class="line">sudo apt-get install nginx</div><div class="line">sudo apt-get install mysql-server mysql-client</div><div class="line"></div><div class="line"># 配置MySQL，ownCloud需要提前创建用户、数据库和分配权限</div><div class="line">&gt; create database 库名 character set utf8 collate utf8_general_ci;  </div><div class="line">&gt; grant ALL on 库名.* 用户名@localhost identified by &quot;密码&quot;   # 注意，ownCloud是不允许root用户的，因为权限太多</div><div class="line"></div><div class="line"># 配置文件权限</div><div class="line">chmod 775 -R owncloud/        # 不要分配777，分配了也不能用</div><div class="line">chown -R www-data:www-data owncloud/</div><div class="line"></div><div class="line"># 配置php5-fpm</div><div class="line">$ printenv PATH 获取系统环境变量</div><div class="line">vim /etc/php5/fpm/pool.d/www.conf，将下面几行前面的注释去掉</div><div class="line">;env[HOSTNAME] = $HOSTNAME  </div><div class="line">;env[PATH] = /usr/local/bin:/usr/bin:/bin      # 这里还要修改为刚才获取到的环境变量  </div><div class="line">;env[TMP] = /tmp  </div><div class="line">;env[TMPDIR] = /tmp  </div><div class="line">;env[TEMP] = /tmp</div><div class="line"></div><div class="line"># 配置nginx，按照官网的教程配置Nginx conf：https://doc.owncloud.org/server/7.0/admin_manual/installation/nginx_configuration.html</div><div class="line"></div><div class="line">对于官网的配置，我做了如下几项修改：</div><div class="line">location ~ .php(?:$|/)$这里面修改为：</div><div class="line">location ~ ^(.+?.php)(/.*)?$ \&#123;  </div><div class="line">  fastcgi_split_path_info ^(.+.php)(/.+)$;  </div><div class="line">  include fastcgi_params;  </div><div class="line">  fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;  </div><div class="line">  fastcgi_param PATH_INFO $fastcgi_path_info;  </div><div class="line">  fastcgi_pass unix:/var/run/php5-fpm.sock;  </div><div class="line">  fastcgi_index index.php;  </div><div class="line">  include fastcgi_params;  </div><div class="line">  fastcgi_param PHP_VALUE &quot;post_max_size=10G \\n upload_max_filesize=10G&quot;;   # 上传默认居然为513MB，这里可以修改大，不然在owncloud无法调整到更大  </div><div class="line">\&#125;</div><div class="line">检查配置文件是否正确用# nginx -t nginx.conf</div></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="TroubleShooting"><a href="#TroubleShooting" class="headerlink" title="TroubleShooting"></a>TroubleShooting</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">## TroubleShooting</div><div class="line">- **中文设置**:</div></pre></td></tr></table></figure>
<pre><code>sudo raspi-config
去掉en_GB.UTF-8 UTF-8
选择“en_US.UTF-8 UTF-8”、“zh_CN.UTF-8 UTF-8”、“zh_CN.GBK GBK”
然后第二个页面默认语言选择en_GB.UTF-8 UTF-8
</code></pre><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">参考：  </div><div class="line">[http://blog.akarin.xyz/raspberry-init/  </div><div class="line">https://github.com/ccforward/cc/issues/25?utm_source=tuicool](http://blog.akar</div><div class="line">in.xyz/raspberry-</div><div class="line">init/https://github.com/ccforward/cc/issues/25?utm_source=tuicool &quot;Link:</div><div class="line">http://blog.akarin.xyz/raspberry-</div><div class="line">init/https://github.com/ccforward/cc/issues/25?utm_source=tuicool&quot; )</div></pre></td></tr></table></figure>
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="https://haofly.net/database-application-scenarios/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="haofly">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/uploads/avatar.png">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="豪翔天下">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="豪翔天下" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/database-application-scenarios/" itemprop="url">
                  各种数据库的应用场景
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2015-12-07T07:48:21+08:00">
                2015-12-07
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/编程之路/" itemprop="url" rel="index">
                    <span itemprop="name">编程之路</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <a href="/database-application-scenarios/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="database-application-scenarios/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <ul>
<li><h1 id="Redis"><a href="#Redis" class="headerlink" title="Redis"></a><strong>Redis</strong></h1></li>
</ul>
<p>统计：比如行为指标、点击量统计、访问量统计、排行榜、最新或最高的N个数据等<br>缓存：会话缓存，页面缓存，全局变量缓存<br>队列：队列服务<br>过期：需要设置过期时间的数据</p>
<ul>
<li><h1 id="MongoDB"><a href="#MongoDB" class="headerlink" title="MongoDB"></a><strong>MongoDB</strong></h1></li>
</ul>
<p>文本：日志、文章等</p>
<ul>
<li></li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="https://haofly.net/internal-network-penetration/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="haofly">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/uploads/avatar.png">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="豪翔天下">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="豪翔天下" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/internal-network-penetration/" itemprop="url">
                  内网穿透方案
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2015-12-04T07:39:55+08:00">
                2015-12-04
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/编程之路/" itemprop="url" rel="index">
                    <span itemprop="name">编程之路</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <a href="/internal-network-penetration/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="internal-network-penetration/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h5 id="背景：天朝大局域网，网上都说可以打电话叫客服切换到公网IP，但是电信、移动宽带，无论打客服还是安装师傅，居然从上到下都不知道公网IP是什么，他们以为我"><a href="#背景：天朝大局域网，网上都说可以打电话叫客服切换到公网IP，但是电信、移动宽带，无论打客服还是安装师傅，居然从上到下都不知道公网IP是什么，他们以为我" class="headerlink" title="背景：天朝大局域网，网上都说可以打电话叫客服切换到公网IP，但是电信、移动宽带，无论打客服还是安装师傅，居然从上到下都不知道公网IP是什么，他们以为我"></a>背景：天朝大局域网，网上都说可以打电话叫客服切换到公网IP，但是电信、移动宽带，无论打客服还是安装师傅，居然从上到下都不知道公网IP是什么，他们以为我</h5><p>要公网IP是要独立宽带，公网IP和共享宽带明明是两个概念好不好，你可以封80端口，但是其它什么端口至少给我留一个总行吧，客服没用，就只能自己动手了。  </p>
<h2 id="方案一：SSH-Tunnel"><a href="#方案一：SSH-Tunnel" class="headerlink" title="方案一：SSH Tunnel"></a>方案一：SSH Tunnel</h2><p>使用SSH进行的Tunnel进行端口转发，对于不需要访问desktop来说是最简单的一种内网穿透方案，当然，唯一的要求是你得有一个有公网IP的服务器做代理。  </p>
<ol>
<li>首先，在内网主机上执行ssh命令：  </li>
</ol>
<pre><code>ssh -NfR 外网ssh端口号:localhost:本地ssh端口号 远端IP
</code></pre><ol>
<li>在代理服务器上执行通过ssh连接内网的服务器：  </li>
</ol>
<pre><code>ssh -p 刚才定义的远程端口号  localhost
</code></pre><ol>
<li>SSH太容易掉线了，为了不掉线，有多种方法：  </li>
</ol>
<pre><code>    # 首先，修改SSH配置
代理服务器段：vim /etc/ssh/sshd_config，修改或新增如下两项


ClinetAliveInterval 60
ClientAliveCountMax 10
然后重启SSH服务：service sshd restart

内网服务器端：vim /etc/ssh/ssh_config，修改或新增


Host *
ServerAliveInterval 30

# 但其实，这两种方法都还是容易掉线，接下来，终极解决方案  



写一个python脚本，然后nohup keepalived.py &amp;，在脚本里新建一个ssh连接，不断发送空格即可

```
#!/usr/bin/python
#coding: utf-8
import paramiko, time

class myssh():  
    def **init**(self, ip, port, username, password):  
    self.ssh = paramiko.SSHClient()  
    self.ssh.set_missing_host_key_policy(paramiko.AutoAddPolicy())  
    self.ssh.connect(ip, port, username, password, timeout=5)  

    def exec(self, cmd):  
        return self.ssh.exec_command(cmd)  

if &apos;__name__ == &apos;__main__&apos;:  
    ssh = myssh(&apos;localhost&apos;, 8022, &apos;haofly&apos;, &apos;896499825&apos;)  
    while True:  
        ssh.exec(&apos; &apos;)  
        time.sleep(30)  
    ssh.close()
</code></pre><p><strong>推荐阅读</strong>：<br><a href="https://v2ex.com/t/268495#reply11" target="_blank" rel="external">几个内网穿透，内网网站穿透，内网端口映射到公网的服务推荐</a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="https://haofly.net/blog-revision/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="haofly">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/uploads/avatar.png">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="豪翔天下">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="豪翔天下" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/blog-revision/" itemprop="url">
                  博客再次改版
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2015-12-02T12:46:10+08:00">
                2015-12-02
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/编程之路/" itemprop="url" rel="index">
                    <span itemprop="name">编程之路</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <a href="/blog-revision/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="blog-revision/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>经过长达5个月的艰辛历程(实际的编程时间少之又少)，终于自己打造出了一个静态博客。虽然没有wordpress那么方便，虽然没有预期中那么漂亮，虽然还有很多功<br>能还没有完善，但是这是我第一次用自己的技术为自己做了一个“会用”的东西。</p>
<p>开博两年多了，从Github的octopress到wordpress再到自己搭建静态博客，写了总共一百多篇文章，由于本次改版采用的是大重构，所以我是一篇文章<br>一篇文章的迁移过来的，只是格式有些还没改动，不过大体能成型了。目前博客有我很喜欢的几大特点：</p>
<p>1.静态化，直接使用nginx实现html文件的静态访问</p>
<p>2.ajax异步提交评论，评论不会立即出发更新html的接口，而是后台审核后才能更新</p>
<p>3.SEO自己做，这个还有很多学习的地方</p>
<p>4.每篇文章对应一张大图，其实是自己爱上摄影后才选择的这个主题，因为这样不仅让我在每篇文章编写时用心，还能用心拍照片(当然，实在没照片的时候就使用的Pixe<br>bay的免费可商用的图片)</p>
<p>5.采用我最喜欢的Python语言进行编写(Djanago框架)</p>
<p>总之，这几个月很少更新博客，原因是公司的事情太多，自己没有合理利用好时间，所以导致这种这个局面。其实，最近几个月的实习，自己还是有很多感悟的，以后会陆续写成<br>文章发表出来的。也不知道有没有人看，反正，开心就好咯。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="https://haofly.net/python-connect-mysql/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="haofly">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/uploads/avatar.png">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="豪翔天下">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="豪翔天下" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/python-connect-mysql/" itemprop="url">
                  Python3 使用MySQL Connector操作数据库
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2015-11-04T17:48:41+08:00">
                2015-11-04
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/编程之路/" itemprop="url" rel="index">
                    <span itemprop="name">编程之路</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <a href="/python-connect-mysql/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="python-connect-mysql/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>参考文档：<br><a href="https://dev.mysql.com/doc/connector-python/en/" target="_blank" rel="external">https://dev.mysql.com/doc/connector-python/en/</a>  </p>
<p><a href="http://mysql-python.sourceforge.net/MySQLdb.html" target="_blank" rel="external">http://mysql-python.sourceforge.net/MySQLdb.html</a>  </p>
<h2 id="安装方法"><a href="#安装方法" class="headerlink" title="安装方法"></a>安装方法</h2><p>支持<code>python3</code>的<code>mysql driver</code>有<code>mysqlclient</code>和<code>pymysql</code>，不推荐只支持2的<code>MySQLdb</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"># ubuntu</div><div class="line">sudo apt-get install python3-dev libmysqlclient-dev</div><div class="line">pip install mysqlclient</div><div class="line"></div><div class="line"># CentOS</div><div class="line">sudo yum install pytho3-devel mysql-devel</div><div class="line">pip install mysqlclient</div></pre></td></tr></table></figure>
<h2 id="数据库的连接"><a href="#数据库的连接" class="headerlink" title="数据库的连接"></a>数据库的连接</h2><p>这里有所有的<a href="https://dev.mysql.com/doc/connector-python/en/connector-python-connectargs.html" target="_blank" rel="external">连接参数列表</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 使用Oracle官方提供的数据库引擎的连接方法</span></div><div class="line"><span class="keyword">import</span> mysql.connector</div><div class="line">cnx = mysql.connector.connect(  </div><div class="line">                          user=<span class="string">''</span>,</div><div class="line">                          password=<span class="string">''</span>,</div><div class="line">                          host=<span class="string">''</span>,</div><div class="line">                          database=<span class="string">''</span>,  </div><div class="line">                          pool_size=<span class="number">3</span> <span class="comment"># 连接池大小)</span></div><div class="line">cnx.close()</div><div class="line"></div><div class="line"><span class="comment"># 使用基于MySQLdb的连接方法，比如mysqlclient</span></div><div class="line"><span class="keyword">import</span> MySQLdb</div><div class="line">db = MySQLdb.connect(</div><div class="line">	host=<span class="string">''</span>, </div><div class="line">    user=<span class="string">''</span>, </div><div class="line">    passwd=<span class="string">''</span>, </div><div class="line">    db=<span class="string">''</span>, </div><div class="line">    charset=<span class="string">'utf8'</span>, </div><div class="line">    autocommit=<span class="keyword">True</span>)</div><div class="line">cursor = db.cursor()</div></pre></td></tr></table></figure>
<h2 id="Difference：两个库的区别"><a href="#Difference：两个库的区别" class="headerlink" title="Difference：两个库的区别"></a>Difference：两个库的区别</h2><pre><code># MySQL Connector/Python
Oracle官方的实现，底层完全用C来实现
默认未开启cursorbuffer，如果需要则显式开启：cnx.cursor(buffered=True)或者mysql.connector.connect(buffered=True)，开启了buffer，可同时使用多个游标

# MySQLdb
不完全用C
默认开启了cursor的，会缓存结果，但是针对特别大的查询，可能会导致程序崩溃
</code></pre><h2 id="CURD操作"><a href="#CURD操作" class="headerlink" title="CURD操作"></a>CURD操作</h2><h3 id="插入"><a href="#插入" class="headerlink" title="插入"></a>插入</h3><pre><code># 插入一条数据
insert_stmt = (
  &quot;INSERT INTO employees (emp_no, first_name, last_name, hire_date) &quot;
  &quot;VALUES (%s, %s, %s, %s)&quot;
)
data = (2, &apos;Jane&apos;, &apos;Doe&apos;, datetime.date(2012, 3, 23))
cursor.execute(insert_stmt, data)

# 同时插入多条数据
data = [
    (&apos;a&apos;, &apos;b&apos;, &apos;c&apos;, &apos;d&apos;),
    (&apos;e&apos;, &apos;f&apos;, &apos;g&apos;, &apos;h&apos;)
]
stmt = &apos;INSERT INTO table_name (field_name1, field_name2)&apos;                 &apos;VALUES(%s, %s)&apos;
cursor.executemany(stmt, data)
</code></pre><h3 id="读取"><a href="#读取" class="headerlink" title="读取"></a>读取</h3><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"># 看了源码发现，fetchone/fatchmany/fetchall实现居然是一样的：https://github.com/PyMySQL/mysqlclient-python/blob/7d289b21728ab1a94bb1f0210a26367c6714d881/MySQLdb/cursors.py，结果都是一次取出保存，这三个方法就是在结果列表里面切片而已</div><div class="line"></div><div class="line"># fetchone</div><div class="line">cursor.execute('select * FROM user")</div><div class="line">row = cursor.fetchone()</div><div class="line">while row is not None:</div><div class="line">    print(row)</div><div class="line">    row = cursor.fetchone()  </div><div class="line"></div><div class="line"># cursor可以直接拿来做迭代器</div><div class="line">cursor.execute(sql)</div><div class="line">for row in cursor:</div><div class="line">    print(row)</div><div class="line"></div><div class="line"># fetchmany()：获取固定数量的结果，当然，每次fetch过后指针会偏移到后面那个地方</div><div class="line">rows = cursor.fetchmany(size=1)</div></pre></td></tr></table></figure>
<h1 id="TroubleShooting"><a href="#TroubleShooting" class="headerlink" title="TroubleShooting"></a>TroubleShooting</h1><ul>
<li><p>获取insert后的ID值  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">db.insert_id()  # 表示上一次插入数据的ID</div></pre></td></tr></table></figure>
</li>
<li><p>获取原始SQL语句</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">print(cursor._last_executed)</div></pre></td></tr></table></figure>
</li>
<li><p>多线程的情况下，出现错误”OperationalError:(2013, ‘Lost connection to MySQL server during query’)”，出现这种情况是因为在多线程的情况下，如果只有一个mysql连接，那么mysql该连接会在执行完一个线程后销毁，需要加锁，在线程里面修改全局变量，会导致该变量的引用出错  </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">LOCK.acquire()  </div><div class="line">mysql.cursor.execute(sql)  </div><div class="line">result = mysql.cursor.fetchall()  </div><div class="line">LOCK.release()  </div><div class="line">print(len(result))</div></pre></td></tr></table></figure>
</li>
<li><p><strong>Can’t connect to local mySQL server ough socket ‘/tmp/mysql.sock</strong></p>
<p>可能原因是由于MySQL是编译安装的，没有放在默认的目录，导致python找不到默认的sock文件，可以用一个软连接将实际文件链接到这个默认的目录下面</p>
</li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="https://haofly.net/supervisor-manage-processor/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="haofly">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/uploads/avatar.png">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="豪翔天下">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="豪翔天下" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/supervisor-manage-processor/" itemprop="url">
                  使用Supervisor管理进程
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2015-08-11T10:07:33+08:00">
                2015-08-11
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/编程之路/" itemprop="url" rel="index">
                    <span itemprop="name">编程之路</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <a href="/supervisor-manage-processor/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="supervisor-manage-processor/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>参考文章：<a href="http://segmentfault.com/a/1190000002991175" target="_blank" rel="external">http://segmentfault.com/a/1190000002991175</a>(原文中还有使用OneAPM安装Python探针的应用，可以实时监控web应用数据，暂时还未实践)</p>
<p>supervisor是使用Python编写的进程管理软件，在实际开发中，一般用它来同时开始一批相关的进程，无论是Django的runserver还是直接管理Nginx、Apache等，都比较方便，这里是其使用方法：</p>
<h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><pre><code># ubuntu
apt-get install supervisor
service supervisor restart

# centos
yum install supervisor
/etc/init.d/supervisord restart


# 如果安装出现unix:///var/run/supervisor.sock no such file这样的错误，那么请参考：http://tuzii.me/diary/522dc528848eea683d7724f2/\%E8\%A7\%A3\%E5\%86\%B3ubuntu-supervisor-unix:var-run-supervisor.sock-no-such-file.\%E7\%9A\%84\%E6\%96\%B9\%E6\%B3\%95




sudo easy_install supervisor
echo_supervisord_conf &gt; supervisord.conf  # 生成一个配置文件
sudo supervisord -c supervisord.conf      # 使用该配置文件启动supervisord
sudo supervisorctl                        # 进入命令行界面管理进程
</code></pre><h2 id="设置一个进程"><a href="#设置一个进程" class="headerlink" title="设置一个进程"></a>设置一个进程</h2><pre><code># 在supervisord.conf里面添加如下内容
[program:frontend]                                           # 进程名
command=/usr/bin/python manage.py runserver 0.0.0.0:8000     # 启动该进程的命令
directory=/media/sf_company/frontend/frontend                # 在执行上面命令前切换到指定目录
startsecs=0
stopwaitsecs=0
autostart=false
autorestart=false
user=root
stdout_logfile=/root/log/8000_access.log                     # 访问日志
stderr_logfile=/root/log/8000_error.log                      # 错误日志
</code></pre><p>这样就创建了一个进程，进程的名称为frontend</p>
<h2 id="supervisorctl常用命令："><a href="#supervisorctl常用命令：" class="headerlink" title="supervisorctl常用命令："></a>supervisorctl常用命令：</h2><pre><code>start name    # 开始一个进程
stop name    # 终止一个进程
status   # 查看当前管理状态
</code></pre>
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="https://haofly.net/ssl-jks-to-pem/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="haofly">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/uploads/avatar.png">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="豪翔天下">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="豪翔天下" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/ssl-jks-to-pem/" itemprop="url">
                  SSL各种格式证书的转换(JKS to PEM, KEY, CRT)
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2015-08-04T11:05:06+08:00">
                2015-08-04
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/编程之路/" itemprop="url" rel="index">
                    <span itemprop="name">编程之路</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <a href="/ssl-jks-to-pem/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="ssl-jks-to-pem/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>原文链接：<a href="http://ju.outofmemory.cn/entry/108566" target="_blank" rel="external">http://ju.outofmemory.cn/entry/108566</a></p>
<p><em>fuck，最讨厌java了，有同事说JKS是Java特有的东西，所以必须调用Java才能使用，but，I use Python，nothing is im<br>possible，发现使用requests来直接调用其它格式的证书文件就行，当然，Python也可以用pyjks包来将jks转换为其它格式，但没必要那样做，<br>因为直接用ssl工具转换就可以一劳永逸了。</em></p>
<p>JKS(Java<br>KeyStore)是Java的一个证书仓库，包括授权整数和公钥整数等。JDK提供了一个工具keytool用于管理keystore。转换步骤：</p>
<ol>
<li><p>使用keytool导出成PKCS12格式：</p>
<h1 id="keytool-importkeystore-srckeystore-server-jks-destkeystore-server-p12-srcstoretype-jks-deststoretype-pkcs12"><a href="#keytool-importkeystore-srckeystore-server-jks-destkeystore-server-p12-srcstoretype-jks-deststoretype-pkcs12" class="headerlink" title="keytool -importkeystore -srckeystore server.jks -destkeystore server.p12 -srcstoretype jks -deststoretype pkcs12"></a>keytool -importkeystore -srckeystore server.jks -destkeystore server.p12 -srcstoretype jks -deststoretype pkcs12</h1><p>输入目标密钥库口令:  </p>
<p>再次输入新口令:<br>输入源密钥库口令:  </p>
<p>已成功导入别名 ca_root 的条目。<br>已完成导入命令: 1 个条目成功导入, 0 个条目失败或取消</p>
</li>
<li><p>生成pem证书(包含了key，server证书和ca证书)：</p>
<h1 id="生成key-加密的pem证书"><a href="#生成key-加密的pem证书" class="headerlink" title="生成key 加密的pem证书"></a>生成key 加密的pem证书</h1><p>$ openssl pkcs12 -in server.p12 -out server.pem<br>Enter Import Password:<br>MAC verified OK<br>Enter PEM pass phrase:<br>Verifying - Enter PEM pass phrase:</p>
</li>
</ol>
<pre><code># 生成key 非加密的pem证书




$ openssl pkcs12 -nodes -in server.p12 -out server.pem
Enter Import Password:
MAC verified OK
</code></pre><ol>
<li><p>单独导出key：</p>
<h1 id="生成加密的key"><a href="#生成加密的key" class="headerlink" title="生成加密的key"></a>生成加密的key</h1><p>$ openssl pkcs12 -in tankywoo.p12  -nocerts -out server.key<br>Enter Import Password:<br>MAC verified OK<br>Enter PEM pass phrase:<br>Verifying - Enter PEM pass phrase:</p>
</li>
</ol>
<pre><code># 生成非加密的key




$ openssl pkcs12 -in tankywoo.p12 -nocerts -nodes -out server.key
Enter Import Password:
MAC verified OK
</code></pre><ol>
<li><p>单独导出server证书：</p>
<p>   $ openssl pkcs12 -in server.p12  -nokeys -clcerts -out server.crt<br>Enter Import Password:<br>MAC verified OK</p>
</li>
<li><p>单独导出ca证书：</p>
<p>   $ openssl pkcs12 -in server.p12  -nokeys -cacerts -out ca.crt<br>Enter Import Password:<br>MAC verified OK</p>
</li>
</ol>
<h1 id="TroubleShooting："><a href="#TroubleShooting：" class="headerlink" title="TroubleShooting："></a>TroubleShooting：</h1><p>1.至于原文中出现的导入ca_root证书出现错误，它那个方法貌似不管用，这里建议将Java升级到Java8即可成功导入。</p>
<p>2.在Python中使用ssl时(无论是用httplib、ssl还是requests)，可能出现以下错误：</p>
<pre><code>Traceback (most recent call last):
  File &quot;client.py&quot;, line 10, in &lt;module&gt;
    ssl_sock.connect((&apos;&apos;, 9000))
  File &quot;/Users/amk/source/p/python/Lib/ssl.py&quot;, line 204, in connect
    self.ca_certs)
ssl.SSLError: [Errno 0] _ssl.c:327: error:00000000:lib(0):func(0):reason(0)
</code></pre><p>根本原因就是提供的证书是错误的</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="https://haofly.net/function-coding-coolshell/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="haofly">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/uploads/avatar.png">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="豪翔天下">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="豪翔天下" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/function-coding-coolshell/" itemprop="url">
                  [转]函数式编程——CoolShell
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2015-07-25T16:35:42+08:00">
                2015-07-25
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/韦编三绝/" itemprop="url" rel="index">
                    <span itemprop="name">韦编三绝</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <a href="/function-coding-coolshell/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="function-coding-coolshell/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>原文地址：<a href="http://coolshell.cn/articles/10822.html" target="_blank" rel="external">http://coolshell.cn/articles/10822.html</a></p>
<blockquote>
<p>本篇文章写于2013年底，而今天我看来，依然是精华中的精华，就喜欢这种深入浅出的文章，带我们对函数式编程更深入的理解，并且本篇文章采用多种语言多种角度来<br>向我们讲解了到底什么才是函数式编程，再加上最近工作上很多的问题，才发现，其实公司之前的代码有很多优秀的地方。</p>
</blockquote>
<p>原文地址：<a href="http://coolshell.cn/articles/10822.html" target="_blank" rel="external">http://coolshell.cn/articles/10822.html</a></p>
<blockquote>
<p>本篇文章写于2013年底，而今天我看来，依然是精华中的精华，就喜欢这种深入浅出的文章，带我们对函数式编程更深入的理解，并且本篇文章采用多种语言多种角度来<br>向我们讲解了到底什么才是函数式编程，再加上最近工作上很多的问题，才发现，其实公司之前的代码有很多优秀的地方。</p>
</blockquote>
<p>当我们说起函数式编程来说，我们会看到如下函数式编程的长相：</p>
<ul>
<li><p>函数式编程的三大特性：<br><strong>immutable data 不可变数据</strong>：像Clojure一样，默认上变量是不可变的，如果你要改变变量，你需要把变量copy出去修改。这样一来，可以让你的程序少很多Bug。因为，程序中的状态不好维护，在并发的时候更不好维护。（你可以试想一下如果你的程序有个复杂的状态，当以后别人改你代码的时候，是很容易出bug的，在并行中这样的问题就更多了）<br><strong>first class functions</strong>：这个技术可以让你的函数就像变量一样来使用。也就是说，你的函数可以像变量一样被创建，修改，并当成变量一样传递，返回或是在函数中嵌套函数。这个有点像Javascript的Prototype（<a href="http://coolshell.cn/articles/6668.html" target="_blank" rel="external">参看Javascript的面向对象编程</a>）<br><strong>尾递归优化</strong>：我们知道递归的害处，那就是如果递归很深的话，stack受不了，并会导致性能大幅度下降。所以，我们使用尾递归优化技术——每次递归时都会重用stack，这样一来能够提升性能，当然，这需要语言或编译器的支持。Python就不支持。</p>
</li>
<li><p>函数式编程的几个技术<br><strong>map &amp; reduce</strong> ：这个技术不用多说了，函数式编程最常见的技术就是对一个集合做Map和Reduce操作。这比起过程式的语言来说，在代码上要更容易阅读。（传统过程式的语言需要使用for/while循环，然后在各种变量中把数据倒过来倒过去的）这个很像C++中的STL中的foreach，find_if，count_if之流的函数的玩法。<br><strong>pipeline</strong>：这个技术的意思是，把函数实例成一个一个的action，然后，把一组action放到一个数组或是列表中，然后把数据传给这个action list，数据就像一个pipeline一样顺序地被各个函数所操作，最终得到我们想要的结果。<br><strong>recursing 递归</strong> ：递归最大的好处就简化代码，他可以把一个复杂的问题用很简单的代码描述出来。注意：递归的精髓是描述问题，而这正是函数式编程的精髓。<br><strong>currying</strong>：把一个函数的多个参数分解成多个函数， 然后把函数多层封装起来，每层函数都返回一个函数去接收下一个参数这样，可以简化函数的多个参数。在C++中，这个很像STL中的bind_1st或是bind2nd。<br><strong>higher order function 高阶函数</strong>：所谓高阶函数就是函数当参数，把传入的函数做一个封装，然后返回这个封装函数。现象上就是函数传进传出，就像面向对象对象满天飞一样。</p>
</li>
<li>还有函数式的一些好处<br><strong>parallelization 并行</strong>：所谓并行的意思就是在并行环境下，各个线程之间不需要同步或互斥。<strong>lazy evaluation 惰性求值</strong>：这个需要编译器的支持。表达式不在它被绑定到变量之后就立即求值，而是在该值被取用的时候求值，也就是说，语句如x:=expression; (把一个表达式的结果赋值给一个变量)明显的调用这个表达式被计算并把结果放置到 x 中，但是先不管实际在 x 中的是什么，直到通过后面的表达式中到 x 的引用而有了对它的值的需求的时候，而后面表达式自身的求值也可以被延迟，最终为了生成让外界看到的某个符号而计算这个快速增长的依赖树。<strong>determinism 确定性</strong>：所谓确定性的意思就是像数学那样 f(x) = y ，这个函数无论在什么场景下，都会得到同样的结果，这个我们称之为函数的确定性。而不是像程序中的很多函数那样，同一个参数，却会在不同的场景下计算出不同的结果。所谓不同的场景的意思就是我们的函数会根据一些运行中的状态信息的不同而发生变化。</li>
</ul>
<p>上面的那些东西太抽象了，还是让我们来循序渐近地看一些例子吧。</p>
<p>我们先用一个最简单的例子来说明一下什么是函数式编程。</p>
<p>先看一个非函数式的例子：</p>
<p>1</p>
<p>2</p>
<p>3</p>
<p>4</p>
<p>|</p>
<p>int cnt;</p>
<p>void increment(){</p>
<p>cnt++;</p>
<p>}  </p>
<p>—|—  </p>
<p>那么，函数式的应该怎么写呢？</p>
<p>1</p>
<p>2</p>
<p>3</p>
<p>|</p>
<p>int increment(int cnt){</p>
<p>return cnt+1;</p>
<p>}  </p>
<p>—|—  </p>
<p>你可能会觉得这个例子太普通了。是的，这个例子就是函数式编程的准则：<strong>不依赖于外部的数据，而且也不改变外部数据的值，而是返回一个新的值给你</strong>。</p>
<p>我们再来看一个简单例子：</p>
<p>1</p>
<p>2</p>
<p>3</p>
<p>4</p>
<p>5</p>
<p>6</p>
<p>7</p>
<p>8</p>
<p>9</p>
<p>10</p>
<p>|</p>
<p>def inc(x):</p>
<p>def incx(y):</p>
<p>return x+y</p>
<p>return incx</p>
<p>inc2 = inc(2)</p>
<p>inc5 = inc(5)</p>
<p>print inc2(5) # 输出 7</p>
<p>print inc5(5) # 输出 10  </p>
<p>—|—  </p>
<p>我们可以看到上面那个例子inc()函数返回了另一个函数incx()，于是我们可以用inc()函数来构造各种版本的inc函数，比如：inc2()和inc5()<br>。这个技术其实就是上面所说的Currying技术。从这个技术上，你可能体会到函数式编程的理念：<strong>把函数当成变量来用，关注于描述问题而不是怎么实现</strong>，这样<br>可以让代码更易读。</p>
<h2 id="Map-amp-Reduce"><a href="#Map-amp-Reduce" class="headerlink" title="Map &amp; Reduce"></a>Map &amp; Reduce</h2><p>在函数式编程中，我们不应该用循环迭代的方式，我们应该用更为高级的方法，如下所示的Python代码</p>
<p>1</p>
<p>2</p>
<p>3</p>
<p>|</p>
<p>name_len = map(len, [“hao”, “chen”, “coolshell”])</p>
<p>print name_len</p>
<h1 id="输出-3-4-9"><a href="#输出-3-4-9" class="headerlink" title="输出 [3, 4, 9]"></a>输出 [3, 4, 9]</h1><p>—|—  </p>
<p>你可以看到这样的代码很易读，因为，<strong>这样的代码是在描述要干什么，而不是怎么干</strong>。</p>
<p>我们再来看一个Python代码的例子：</p>
<p>1</p>
<p>2</p>
<p>3</p>
<p>4</p>
<p>5</p>
<p>6</p>
<p>|</p>
<p>def toUpper(item):</p>
<p>return item.upper()</p>
<p>upper_name = map(toUpper, [“hao”, “chen”, “coolshell”])</p>
<p>print upper_name</p>
<h1 id="输出-‘HAO’-‘CHEN’-‘COOLSHELL’"><a href="#输出-‘HAO’-‘CHEN’-‘COOLSHELL’" class="headerlink" title="输出 [‘HAO’, ‘CHEN’, ‘COOLSHELL’]"></a>输出 [‘HAO’, ‘CHEN’, ‘COOLSHELL’]</h1><p>—|—  </p>
<p>顺便说一下，上面的例子个是不是和我们的STL的transform有些像？</p>
<p>1</p>
<p>2</p>
<p>3</p>
<p>4</p>
<p>5</p>
<p>6</p>
<p>7</p>
<p>8</p>
<p>9</p>
<p>10</p>
<p>11</p>
<p>12</p>
<p>|</p>
<p>#include <iostream></iostream></p>
<p>#include <algorithm></algorithm></p>
<p>#include <string></string></p>
<p>using namespace std;</p>
<p>int main() {</p>
<p>string s=”hello”;</p>
<p>string out;</p>
<p>transform(s.begin(), s.end(), back_inserter(out), ::toupper);</p>
<p>cout &lt;&lt; out &lt;&lt; endl;</p>
<p>// 输出：HELLO</p>
<p>}  </p>
<p>—|—  </p>
<p>在上面Python的那个例子中我们可以看到，我们写义了一个函数toUpper，这个函数没有改变传进来的值，只是把传进来的值做个简单的操作，然后返回。然后，我<br>们把其用在map函数中，就可以很清楚地描述出我们想要干什么。而不会去理解一个在循环中的怎么实现的代码，最终在读了很多循环的逻辑后才发现原来是这个或那个意思。<br>下面，我们看看描述实现方法的过程式编程是怎么玩的（看上去是不是不如函数式的清晰？）：</p>
<p>1</p>
<p>2</p>
<p>3</p>
<p>4</p>
<p>|</p>
<p>upname =[‘HAO’, ‘CHEN’, ‘COOLSHELL’]</p>
<p>lowname =[]</p>
<p>for i in range(len(upname)):</p>
<p>lowname.append( upname[i].lower() )  </p>
<p>—|—  </p>
<p>对于map我们别忘了lambda表达式：你可以简单地理解为这是一个inline的匿名函数。下面的lambda表达式相当于：def func(x):<br>return x*x</p>
<p>1</p>
<p>2</p>
<p>3</p>
<p>|</p>
<p>squares = map(lambda x: x * x, range(9))</p>
<p>print squares</p>
<h1 id="输出-0-1-4-9-16-25-36-49-64"><a href="#输出-0-1-4-9-16-25-36-49-64" class="headerlink" title="输出 [0, 1, 4, 9, 16, 25, 36, 49, 64]"></a>输出 [0, 1, 4, 9, 16, 25, 36, 49, 64]</h1><p>—|—  </p>
<p>我们再来看看reduce怎么玩？（下面的lambda表达式中有两个参数，也就是说每次从列表中取两个值，计算结果后把这个值再放回去，下面的表达式相当于：(((<br>(1+2)+3)+4)+5) ）</p>
<p>1</p>
<p>2</p>
<p>|</p>
<p>print reduce(lambda x, y: x+y, [1, 2, 3, 4, 5])</p>
<h1 id="输出-15"><a href="#输出-15" class="headerlink" title="输出 15"></a>输出 15</h1><p>—|—  </p>
<p>Python中的除了map和reduce外，还有一些别的如filter, find, all,<br>any的函数做辅助（其它函数式的语言也有），可以让你的代码更简洁，更易读。 我们再来看一个比较复杂的例子：</p>
<p>计算数组中正数的平均值</p>
<p>1</p>
<p>2</p>
<p>3</p>
<p>4</p>
<p>5</p>
<p>6</p>
<p>7</p>
<p>8</p>
<p>9</p>
<p>10</p>
<p>11</p>
<p>12</p>
<p>13</p>
<p>|</p>
<p>num =[2, -5, 9, 7, -2, 5, 3, 1, 0, -3, 8]</p>
<p>positive_num_cnt = 0</p>
<p>positive_num_sum = 0</p>
<p>for i in range(len(num)):</p>
<p>if num[i] &gt; 0:</p>
<p>positive_num_cnt += 1</p>
<p>positive_num_sum += num[i]</p>
<p>if positive_num_cnt &gt; 0:</p>
<p>average = positive_num_sum / positive_num_cnt</p>
<p>print average</p>
<h1 id="输出-5"><a href="#输出-5" class="headerlink" title="输出 5"></a>输出 5</h1><p>—|—  </p>
<p>如果用函数式编程，这个例子可以写成这样：</p>
<p>1</p>
<p>2</p>
<p>|</p>
<p>positive_num = filter(lambda x: x&gt;0, num)</p>
<p>average = reduce(lambda x,y: x+y, positive_num) / len( positive_num )  </p>
<p>—|—  </p>
<p>C++11玩的法：</p>
<p>1</p>
<p>2</p>
<p>3</p>
<p>4</p>
<p>5</p>
<p>6</p>
<p>7</p>
<p>8</p>
<p>9</p>
<p>10</p>
<p>11</p>
<p>12</p>
<p>|</p>
<p>#include <iostream></iostream></p>
<p>#include <algorithm></algorithm></p>
<p>#include <numeric></numeric></p>
<p>#include <string></string></p>
<p>#include <vector></vector></p>
<p>using namespace std;</p>
<p>vector num {2, -5, 9, 7, -2, 5, 3, 1, 0, -3, 8};</p>
<p>vector p_num;</p>
<p>copy_if(num.begin(), num.end(&lt;span class=”crayon-sy” sty</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="https://haofly.net/apache-vs-nginx/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="haofly">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/uploads/avatar.png">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="豪翔天下">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="豪翔天下" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/apache-vs-nginx/" itemprop="url">
                  [转]Apache vs Nginx: Practical Considerations
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2015-07-18T09:34:47+08:00">
                2015-07-18
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/编程之路/" itemprop="url" rel="index">
                    <span itemprop="name">编程之路</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <a href="/apache-vs-nginx/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="apache-vs-nginx/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>原文地址：<a href="https://www.digitalocean.com/community/tutorials/apache-vs-nginx-
practical-considerations" target="_blank" rel="external">https://www.digitalocean.com/community/tutorials/apache-vs-nginx-
practical-considerations</a></p>
<blockquote>
<p><strong>总之就是各有各的优点，最好的方式就是nginx在前面做反向代理，并顺便处理静态内容，而apache则负责处理动态内容。</strong></p>
</blockquote>
<h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h2><p>Apache and Nginx are the two most common open source web servers in the world.<br>Together, they are responsible for serving over 50\% of traffic on the<br>internet. Both solutions are capable of handling diverse workloads and working<br>with other software to provide a complete web stack.</p>
<p>While Apache and Nginx share many qualities, they should not be thought of as<br>entirely interchangeable. Each excels in its own way and it is important to<br>understand the situations where you may need to reevaluate your web server of<br>choice. This article will be devoted to a discussion of how each server stacks<br>up in various areas.</p>
<h2 id="General-Overview"><a href="#General-Overview" class="headerlink" title="General Overview"></a>General Overview</h2><p>Before we dive into the differences between Apache and Nginx, let’s take a<br>quick look at the background of these two projects and their general<br>characteristics.</p>
<h4 id="Apache"><a href="#Apache" class="headerlink" title="Apache"></a>Apache</h4><p>The Apache HTTP Server was created by Robert McCool in 1995 and has been<br>developed under the direction of the Apache Software Foundation since 1999.<br>Since the HTTP web server is the foundation’s original project and is by far<br>their most popular piece of software, it is often referred to simply as<br>“Apache”.</p>
<p>The Apache web server has been the most popular server on the internet since</p>
<ol>
<li>Because of this popularity, Apache benefits from great documentation and<br>integrated support from other software projects.</li>
</ol>
<p>Apache is often chosen by administrators for its flexibility, power, and<br>widespread support. It is extensible through a dynamically loadable module<br>system and can process a large number of interpreted languages without<br>connecting out to separate software.</p>
<h4 id="Nginx"><a href="#Nginx" class="headerlink" title="Nginx"></a>Nginx</h4><p>In 2002, Igor Sysoev began work on Nginx as an answer to the C10K problem,<br>which was a challenge for web servers to begin handling ten thousand<br>concurrent connections as a requirement for the modern web. The initial public<br>release was made in 2004, meeting this goal by relying on an asynchronous(异步),<br>events-driven(事件驱动) architecture.</p>
<p>Nginx has grown in popularity since its release due to its light-weight<br>resource utilization and its ability to scale easily on minimal hardware.<br>Nginx excels at serving static content(静态内容) quickly and is designed to pass<br>dynamic requests off to other software that is better suited for those<br>purposes.</p>
<p>Nginx is often selected by administrators for its resource efficiency and<br>responsiveness under load. Advocates welcome Nginx’s focus on core web server<br>and proxy features.</p>
<h2 id="Connection-Handling-Architecturel-连接处理架构"><a href="#Connection-Handling-Architecturel-连接处理架构" class="headerlink" title="Connection Handling Architecturel(连接处理架构)"></a>Connection Handling Architecturel(连接处理架构)</h2><p>One big difference between Apache and Nginx is the actual way that they handle<br>connections and traffic. This provides perhaps the most significant difference<br>in the way that they respond to different traffic conditions.</p>
<h4 id="Apache-1"><a href="#Apache-1" class="headerlink" title="Apache"></a>Apache</h4><p>Apache provides a variety of multi-processing modules (Apache calls these<br>MPMs) that dictate(决定) how client requests are handled. Basically, this allows<br>administrators to swap out its connection handling architecture easily. These<br>are:</p>
<ul>
<li><strong>mpm_prefork</strong>: This processing module spawns(产生) processes with a single thread each to handle request(一个请求一个线程). Each child can handle a single connection at a time. As long as the number of requests is fewer than the number of processes, this MPM is very fast(请求数量比进程数量少的时候会很快). However, performance degrades quickly after the requests surpass the number of processes, so this is not a good choice in many scenarios. Each process has a significant impact on RAM consumption, so this MPM is difficult to scale effectively. This may still be a good choice though if used in conjunction with other components that are not built with threads in mind. For instance, PHP is not thread-safe, so this MPM is recommended as the only safe way of working with mod_php, the Apache module for processing these files.</li>
<li><strong>mpm_worker</strong>: This module spawns processes that can each manage multiple threads(每个进程可以管理多个线程). Each of these threads can handle a single connection. Threads are much more efficient than processes(线程比进程更高效), which means that this MPM scales better than the prefork MPM. Since there are more threads than processes, this also means that new connections can immediately take a free thread instead of having to wait for a free process(处理新的连接只需要有新的线程而不需要等待进程释放).</li>
<li><strong>mpm_event</strong>: This module is similar to the worker module in most situations, but is optimized to handle keep-alive connections(对持久连接进行了优化). When using the worker MPM, a connection will hold a thread regardless of whether a request is actively being made for as long as the connection is kept alive. The event MPM handles keep alive connections by setting aside dedicated(专用的) threads for handling keep alive connections and passing active requests off to other threads. This keeps the module from getting bogged down by keep-alive requests, allowing for faster execution. This was marked stable with the release of Apache 2.4. As you can see, Apache provides a flexible architecture for choosing different connection and request handling algorithms. The choices provided are mainly a function of the server’s evolution and the increasing need for concurrency as the internet landscape has changed.</li>
</ul>
<h4 id="Nginx-1"><a href="#Nginx-1" class="headerlink" title="Nginx"></a>Nginx</h4><p>Nginx came onto the scene after Apache, with more awareness of the concurrency<br>problems that would face sites at scale(更注重并发问题). Leveraging(利用) this<br>knowledge, Nginx was designed from the ground up to use an asynchronous, non-<br>blocking, event-driven connection handling algorithm.</p>
<p>Nginx spawns worker processes, each of which can handle thousands of<br>connections(产生的是worker进程，每个都可以处理上千个连接). The worker processes accomplish this<br>by implementing a fast looping mechanism(快速的循环机制) that continuously checks for<br>and processes events. Decoupling(解耦) actual work from connections allows each<br>worker to concern itself with a connection only when a new event has been<br>triggered.</p>
<p>Each of the connections handled by the worker are placed within the event loop<br>where they exist with other connections. Within the loop, events are processed<br>asynchronously, allowing work to be handled in a non-blocking manner. When the<br>connection closes, it is removed from the loop.</p>
<p>This style of connection processing allows Nginx to scale incredibly far with<br>limited resources. Since the server is single-threaded and processes are not<br>spawned to handle each new connection, the memory and CPU usage tends to stay<br>relatively consistent, even at times of heavy load.</p>
<h1 id="Static-vs-Dynamic-Content"><a href="#Static-vs-Dynamic-Content" class="headerlink" title="Static vs Dynamic Content"></a>Static vs Dynamic Content</h1><p>In terms of real world use-cases, one of the most common comparisons between<br>Apache and Nginx is the way in which each server handles requests for static<br>and dynamic content.</p>
<h4 id="Apache-2"><a href="#Apache-2" class="headerlink" title="Apache"></a>Apache</h4><p>Apache servers can handle static content using its conventional file-based<br>methods. The performance of these operations is mainly a function of the MPM<br>methods described above.</p>
<p>Apache can also process dynamic content by embedding(嵌入) a processor of the<br>language in question into each of its worker instances. This allows it to<br>execute dynamic content within the web server itself without having to rely on<br>external components. These dynamic processors can be enabled through the use<br>of dynamically loadable modules.</p>
<p>Apache’s ability to handle dynamic content internally means that configuration<br>of dynamic processing tends to be simpler. Communication does not need to be<br>coordinated with an additional piece of software and modules can easily be<br>swapped out if the content requirements change.</p>
<h4 id="Nginx-2"><a href="#Nginx-2" class="headerlink" title="Nginx"></a>Nginx</h4><p>Nginx does not have any ability to process dynamic content<br>natively(本身无法处理动态内容). To handle PHP and other requests for dynamic content,<br>Nginx must pass to an external processor for execution and wait for the<br>rendered content to be sent back(必须使用外部的执行程序然后等待返回). The results can then be<br>relayed to the client.</p>
<p>For administrators, this means that communication must be configured between<br>Nginx and the processor over one of the protocols Nginx knows how to speak<br>(http, FastCGI, SCGI, uWSGI, memcache). This can complicate things slightly,<br>especially when trying to anticipate the number of connections to allow, as an<br>additional connection will be used for each call to the processor.</p>
<p>However, this method has some advantages as well. Since the dynamic<br>interpreter is not embedded in the worker process, its overhead will only be<br>present for dynamic content. Static content can be served in a straight-<br>forward manner and the interpreter will only be contacted when needed. Apache<br>can also function in this manner, but doing so removes the benefits in the<br>previous section.</p>
<h1 id="Distributed-vs-Centralized-Configuration"><a href="#Distributed-vs-Centralized-Configuration" class="headerlink" title="Distributed vs Centralized Configuration"></a>Distributed vs Centralized Configuration</h1><p>For administrators, one of the most readily apparent differences between these<br>two pieces of software is whether directory-level configuration is permitted<br>within the content directories.</p>
<h4 id="Apache-3"><a href="#Apache-3" class="headerlink" title="Apache"></a>Apache</h4><p>Apache includes an option to allow additional configuration on a per-directory<br>basis by inspecting and interpreting directives in hidden files within the<br>content directories themselves. These files are known as .htaccess<br>files.(可以管理每个目录)</p>
<p>Since these files reside within the content directories themselves, when<br>handling a request, Apache checks each component of the path to the requested<br>file for an .htaccess file and applies the directives found within. This<br>effectively allows decentralized configuration of the web server, which is<br>often used for implementing URL rewrites, access restrictions, authorization<br>and authentication, even caching policies.</p>
<p>While the above examples can all be configured in the main Apache<br>configuration file,.htaccess files have some important advantages. First,<br>since these are interpreted each time they are found along a request path,<br>they are implemented immediately without reloading the server. Second, it<br>makes it possible to allow non-privileged users to control certain aspects of<br>their own web content without giving them control over the entire<br>configuration file.</p>
<p>This provides an easy way for certain web software, like content management<br>systems, to configure their environment without providing access to the<br>central configuration file. This is also used by shared hosting providers to<br>retain control of the main configuration while giving clients control over<br>their specific directories.</p>
<h4 id="Nginx-3"><a href="#Nginx-3" class="headerlink" title="Nginx"></a>Nginx</h4><p>Nginx does not interpret .htaccess files, nor does it provide any mechanism<br>for evaluating per-directory configuration outside of the main configuration<br>file. This may be less flexible than the Apache model, but it does have its<br>own advantages.</p>
<p>The most notable improvement over the .htaccess system of directory-level<br>configuration is increased performance. For a typical Apache setup that may<br>allow .htaccess in any directory, the server will check for these files in<br>each of the parent directories leading up to the requested file, for each<br>request. If one or more .htaccess files are found during this search, they<br>must be read and interpreted. By not allowing directory overrides, Nginx can<br>serve requests faster by doing a single directory lookup and file read for<br>each request (assuming that the file is found in the conventional directory<br>structure).</p>
<p>Another advantage is security related(安全). Distributing directory-level<br>configuration access also distributes the responsibility of security to<br>individual users, who may not be trusted to handle this task well. Ensuring<br>that the administrator maintains control over the entire web server can<br>prevent some security missteps that may occur when access is given to other<br>parties.</p>
<p>Keep in mind that it is possible to turn off .htaccess interpretation in<br>Apache if these concerns resonate with you.</p>
<h1 id="File-vs-URI-Based-Interpretation"><a href="#File-vs-URI-Based-Interpretation" class="headerlink" title="File vs URI-Based Interpretation"></a>File vs URI-Based Interpretation</h1><p>How the web server interprets requests and maps them to actual resources on<br>the system is another area where these two servers differ.</p>
<h4 id="Apache-4"><a href="#Apache-4" class="headerlink" title="Apache"></a>Apache</h4><p>Apache provides the ability to interpret a request as a physical resource on<br>the filesystem or as a URI location that may need a more abstract evaluation.<br>In general, for the former Apache uses <directory> or <files> blocks, while it<br>utilizes <location> blocks for more abstract resources.</location></files></directory></p>
<p>Because Apache was designed from the ground up as a web server, the default is<br>usually to interpret requests as filesystem resources. It begins by taking the<br>document root and appending the portion of the request following the host and<br>port number to try to find an actual file. Basically, the filesystem hierarchy<br>is represented on the web as the available document tree.</p>
<p>Apache provides a number of alternatives for when the request does not match<br>the underlying filesystem. For instance, an Alias directive can be used to map<br>to an alternative location. Using <location> blocks is a method of working<br>with the URI itself instead of the filesystem. There are also regular<br>expression variants which can be used to apply configuration more flexibly<br>throughout the filesystem.</location></p>
<p>While Apache has the ability to operate on both the underlying filesystem and<br>the webspace, it leans heavily towards filesystem methods. This can be seen in<br>some of the design decisions, including the use of .htaccess files for per-<br>directory configuration. The Apache docs themselves warn against using URI-<br>based blocks to restrict access when the request mirrors the underlying<br>filesystem.</p>
<h4 id="Nginx-4"><a href="#Nginx-4" class="headerlink" title="Nginx"></a>Nginx</h4><p>Nginx was created to be both a web server and a proxy server. Due to the<br>architecture required for these two roles, it works primarily with URIs,<br>translating to the filesystem when necessary.</p>
<p>This can be seen in some of the ways that Nginx configuration files are<br>constructed and interpreted.Nginx does not provide a mechanism for specifying<br>configuration for a filesystem directory and instead parses the URI itself.</p>
<p>For instance, the primary configuration blocks for Nginx are server and<br>location blocks. The server block interprets the host being requested, while<br>the location blocks are responsible for matching portions of the URI that<br>comes after the host and port. At this point, the request is being interpreted<br>as a URI, not as a location on the filesystem.</p>
<p>For static files, all requests eventually have to be mapped to a location on<br>the filesystem. First, Nginx selects the server and location blocks that will<br>handle the request and then combines the document root with the URI, adapting<br>anything necessary according to the configuration specified.</p>
<p>This may seem similar, but parsing requests primarily as URIs instead of<br>filesystem locations allows Nginx to more easily function in both web, mail,<br>and proxy server roles. Nginx is configured simply by laying out how to<br>respond to different request patterns. Nginx does not check the filesystem<br>until it is ready to serve the request, which explains why it does not<br>implement a form of .htaccess files.</p>
<h1 id="Modules"><a href="#Modules" class="headerlink" title="Modules"></a>Modules</h1><p>Both Nginx and Apache are extensible through module systems, but the way that<br>they work differ significantly.</p>
<h4 id="Apache-5"><a href="#Apache-5" class="headerlink" title="Apache"></a>Apache</h4><p>Apache’s module system allows you to dynamically load or unload modules to<br>satisfy your needs during the course of running the server. The Apache core is<br>always present, while modules can be turned on or off, adding or removing<br>additional functionality and hooking into the main server.</p>
<p>Apache uses this functionality for a large variety tasks. Due to the maturity<br>of the platform, there is an extensive library of modules available. These can<br>be used to alter some of the core functionality of the server, such as<br>mod_php, which embeds a PHP interpreter into each running worker.</p>
<p>Modules are not limited to processing dynamic content, however. Among other<br>functions, they can be used for rewriting URLs, authenticating clients,<br>hardening the server, logging, caching, compression, proxying, rate limiting,<br>and encrypting. Dynamic modules can extend the core functionality considerably<br>without much additional work.</p>
<h4 id="Nginx-5"><a href="#Nginx-5" class="headerlink" title="Nginx"></a>Nginx</h4><p>Nginx also implements a module system, but it is quite different from the<br>Apache system. In Nginx, modules are not dynamically loadable, so they must be<br>selected and compiled into the core software(模块居然不是动态加载的).</p>
<p>For many users, this will make Nginx much less flexible. This is especially<br>true for users who are not comfortable maintaining their own compiled software<br>outside of their distribution’s conventional packaging system. While<br>distributions’ packages tend to include the most commonly used modules, if you<br>require a non-standard module, you will have to build the server from source<br>yourself.</p>
<p>Nginx modules are still very useful though, and they allow you to dictate what<br>you want out of your server by only including the functionality you intend to<br>use. Some users also may consider this more secure, as arbitrary components<br>cannot be hooked into the server. However, if your server is ever put in a<br>position where this is possible, it is likely compromised already.</p>
<p>Nginx modules allow many of the same capabilities as Apache modules. For<br>instance, Nginx modules can provide proxying support, compression, rate<br>limiting, logging, rewriting, geolocation, authentication, encryption,<br>streaming, and mail functionality.</p>
<h2 id="Support-Compatibility-Ecosystem-and-Documentation"><a href="#Support-Compatibility-Ecosystem-and-Documentation" class="headerlink" title="Support, Compatibility, Ecosystem, and Documentation"></a>Support, Compatibility, Ecosystem, and Documentation</h2><p>A major point to consider is what the actual process of getting up and running<br>will be given the landscape of available help and support among other<br>software.</p>
<h4 id="Apache-6"><a href="#Apache-6" class="headerlink" title="Apache"></a>Apache</h4><p>Because Apache has been popular for so long, support for the server is fairly<br>ubiquitous. There is a large library of first- and third-party documentation<br>available for the core server and for task-based scenarios involving hooking<br>Apache up with other software.</p>
<p>Along with documentation, many tools and web projects include tools to<br>bootstrap themselves within an Apache environment. This may be included in the<br>projects themselves, or in the packages maintained by your distribution’s<br>packaging team.</p>
<p>Apache, in general, will have more support from third-party projects simply<br>because of its market share and the length of time it has been available.<br>Administrators are also somewhat more likely to have experience working with<br>Apache not only due to its prevalence, but also because many people start off<br>in shared-hosting scenarios which almost exclusively rely on Apache due to the<br>.htaccess distributed management capabilities.</p>
<h4 id="Nginx-6"><a href="#Nginx-6" class="headerlink" title="Nginx"></a>Nginx</h4><p>Nginx is experiencing increased support as more users adopt it for its<br>performance profile, but it still has some catching up to do in some key<br>areas.</p>
<p>In the past, it was difficult to find comprehensive English-language<br>documentation regarding Nginx due to the fact that most of the early<br>development and documentation were in Russian. As interest in the project<br>grew, the documentation has been filled out and there are now plenty of<br>administration resources on the Nginx site and through third parties.</p>
<p>In regards to third-party applications, support and documentation is becoming<br>more readily available, and package maintainers are beginning, in some cases,<br>to give choices between auto-configuring for Apache and Nginx. Even without<br>support, configuring Nginx to work with alternative software is usually<br>straight-forward so long as the project itself documents its requirements<br>(permissions, headers, etc).</p>
<h2 id="Using-Apache-and-Nginx-Together"><a href="#Using-Apache-and-Nginx-Together" class="headerlink" title="Using Apache and Nginx Together"></a>Using Apache and Nginx Together</h2><p>After going over the benefits and limitations of both Apache and Nginx, you<br>may have a better idea of which server is more suited to your needs. However,<br>many users find that it is possible to leverage each server’s strengths by<br>using them together.</p>
<p>The conventional configuration for this partnership is to place Nginx in front<br>of Apache as a reverse proxy(Nginx做反向代理). This will allow Nginx to handle all<br>requests from clients. This takes advantage of Nginx’s fast processing speed<br>and ability to handle large numbers of connections concurrently.</p>
<p>For static content, which Nginx excels at, the files will be served quickly<br>and directly to the client. For dynamic content, for instance PHP files, Nginx<br>will proxy the request to Apache, which can then process the results and<br>return the rendered page. Nginx can then pass the content back to the client.</p>
<p>This setup works well for many people because it allows Nginx to function as a<br>sorting machine. It will handle all requests it can and pass on the ones that<br>it has no native ability to serve. By cutting down on the requests the Apache<br>server is asked to handle, we can alleviate some of the blocking that occurs<br>when an Apache process or thread is occupied.</p>
<p>This configuration also allows you to scale out by adding additional backend<br>servers as necessary. Nginx can be configured to pass to a pool of servers<br>easily, increasing this configuration’s resilience to failure and performance.</p>
<h2 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h2><p>As you can see, both Apache and Nginx are powerful, flexible, and capable.<br>Deciding which server is best for you is largely a function of evaluating your<br>specific requirements and testing with the patterns that you expect to see.</p>
<p>There are differences between these projects that have a very real impact on<br>the raw performance, capabilities, and the implementation time necessary to<br>get each solution up and running. However, these usually are the result of a<br>series of trade offs that should not be casually dismissed. In the end, there<br>is no one-size-fits-all web server, so use the solution that best aligns with<br>your objectives.</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/3/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/3/">3</a><span class="page-number current">4</span><a class="page-number" href="/page/5/">5</a><span class="space">&hellip;</span><a class="page-number" href="/page/15/">15</a><a class="extend next" rel="next" href="/page/5/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/uploads/avatar.png"
               alt="haofly" />
          <p class="site-author-name" itemprop="name">haofly</p>
          <p class="site-description motion-element" itemprop="description">豪翔天下的个人博客</p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">147</span>
              <span class="site-state-item-name">日志</span>
            </a>
          </div>

          
            <div class="site-state-item site-state-categories">
              
                <span class="site-state-item-count">6</span>
                <span class="site-state-item-name">分类</span>
              
            </div>
          

          

        </nav>

        
          <div class="feed-link motion-element">
            <a href="/atom.xml" rel="alternate">
              <i class="fa fa-rss"></i>
              RSS
            </a>
          </div>
        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/haoflynet" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                  GitHub
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://weibo.com/haoflynet" target="_blank" title="微博">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  微博
                </a>
              </span>
            
          
        </div>

        
        

        
        
          <div class="links-of-blogroll motion-element links-of-blogroll-inline">
            <div class="links-of-blogroll-title">
              <i class="fa  fa-fw fa-globe"></i>
              小伙伴们
            </div>
            <ul class="links-of-blogroll-list">
              
                <li class="links-of-blogroll-item">
                  <a href="https://www.phodal.com" title="Phodal" target="_blank">Phodal</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://zkzhao.github.io/" title="zkzhao" target="_blank">zkzhao</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://blog.qingguoing.com/" title="倾国倾城的博客" target="_blank">倾国倾城的博客</a>
                </li>
              
            </ul>
          </div>
        

        


      </section>

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2016</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">haofly</span>
</div>


<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Pisces
  </a>
</div>


        

        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  



  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.0"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.0"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.0"></script>



  

  
    
  

  <script type="text/javascript">
    var duoshuoQuery = {short_name:"haoflynet"};
    (function() {
      var ds = document.createElement('script');
      ds.type = 'text/javascript';ds.async = true;
      ds.id = 'duoshuo-script';
      ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
      ds.charset = 'UTF-8';
      (document.getElementsByTagName('head')[0]
      || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
  </script>

  
    
    
    <script src="/lib/ua-parser-js/dist/ua-parser.min.js?v=0.7.9"></script>
    <script src="/js/src/hook-duoshuo.js"></script>
  








  
  

  

  

  

  


</body>
</html>
